{"version":3,"file":"atomico-base-element.js","sources":["../src/index.js"],"sourcesContent":["/**\r\n * Applies JSON.parse to extract the real value of an attribute from a string.\r\n * @param {string} value\r\n * @returns {(boolean|string|number|Object|Array)}\r\n **/\r\nfunction parse(value) {\r\n\treturn JSON.parse(value);\r\n}\r\n\r\nexport default class Element extends HTMLElement {\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\t/**@type {Object<string,any>} */\r\n\t\tthis.props = {};\r\n\t\t/**@type {Promise} */\r\n\t\tthis.mounted = new Promise(resolve => (this.mount = resolve));\r\n\t\t/**@type {Promise} */\r\n\t\tthis.unmounted = new Promise(resolve => (this.unmount = resolve));\r\n\t}\r\n\tconnectedCallback() {\r\n\t\tthis.mount();\r\n\t}\r\n\tdisconnectedCallback() {\r\n\t\tthis.unmount();\r\n\t}\r\n\tattributeChangedCallback(name, oldValue, value) {\r\n\t\tif (oldValue == value) return;\r\n\t\tthis.setProperty(name, value);\r\n\t}\r\n\tstatic get observedAttributes() {\r\n\t\tlet observables = this.observables || {},\r\n\t\t\tattributes = [],\r\n\t\t\t/**\r\n\t\t\t * @param {string} - add the setter and getter to the constructor prototype\r\n\t\t\t */\r\n\t\t\tproxy = name => {\r\n\t\t\t\tObject.defineProperty(this.prototype, name, {\r\n\t\t\t\t\tset(value) {\r\n\t\t\t\t\t\tthis.setProperty(name, value);\r\n\t\t\t\t\t},\r\n\t\t\t\t\tget() {\r\n\t\t\t\t\t\treturn this.props[name];\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t};\r\n\t\tfor (let key in observables) {\r\n\t\t\tlet attr = key.replace(/([A-Z])/g, \"-$1\").toLowerCase();\r\n\t\t\tattributes.push(attr);\r\n\t\t\tif (!(name in this.prototype)) proxy(key);\r\n\t\t}\r\n\t\treturn attributes;\r\n\t}\r\n\t/**\r\n\t * validate to `value`, and then deliver it to the` update` method.\r\n\t * @param {name} name\r\n\t * @param {*} value\r\n\t */\r\n\tsetProperty(name, value) {\r\n\t\tname = name.replace(/-(\\w)/g, (all, letter) => letter.toUpperCase());\r\n\t\tlet { observables } = this.constructor,\r\n\t\t\terror,\r\n\t\t\ttype = observables[name];\r\n\t\ttry {\r\n\t\t\tif (typeof value == \"string\") {\r\n\t\t\t\tswitch (type) {\r\n\t\t\t\t\tcase Boolean:\r\n\t\t\t\t\t\tvalue = parse(value || \"true\") == true;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase Number:\r\n\t\t\t\t\t\tvalue = Number(value);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase Object:\r\n\t\t\t\t\tcase Array:\r\n\t\t\t\t\t\tvalue = parse(value);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} catch (e) {\r\n\t\t\terror = true;\r\n\t\t}\r\n\t\tif (!error && {}.toString.call(value) == `[object ${type.name}]`) {\r\n\t\t\tthis.update({ [name]: value });\r\n\t\t} else {\r\n\t\t\tthrow `the attribute [${name}] must be of the type [${type.name}]`;\r\n\t\t}\r\n\t}\r\n\t/**\r\n\t * @param {Object<string,any>} props\r\n\t */\r\n\tupdate(props) {}\r\n}\r\n"],"names":[],"mappings":"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"}